{% extends 'admin/base_site.html' %}
{% load static %}
{% block extrahead %}
<style>
    thead {
        position: sticky;
        top: 0;
    }
    .menu-types{
        margin: 12px;
        border: solid rgba(72,81,141,0.75);
        border-radius: 4px;
        padding: 3px;
    }
</style>
{% endblock %}
{% block title %}Настройка компонентов{% endblock %}

{% block content %}
    <div class="fieldsets">
        <fieldset class="module">
            <h1>Настройка видимости компонентов на странице расчета</h1>
            <div>
                Настройка по статусам:
                <div style="padding: 12px;">
                    <span class="menu-types"><a href="{% url 'components_view' %}?model=StatusDocType">по типу документа</a></span>
                    <span class="menu-types"><a href="{% url 'components_view' %}?model=StatusUser">по типу пользоватля</a></span>
                    <span class="menu-types"><a href="{% url 'components_view' %}?model=StatusCalculation">по статусу расчета</a></span>
                    <span class="menu-types"><a href="{% url 'components_view' %}?model=StatusWorkType">по статусу занятости расчета</a></span>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="table-components">
    <table border="1">
       <thead><tr>
       <th><input type="checkbox" id="selectAll" onchange="selectAll(this)"></th>
       <th>название</th>
       <th>data_id</th>
           {% for status in STATUSES %}
        <th>{{ status.name }}</th>
           {% endfor %}
       </tr></thead>
    {% for component in COMPONENTS %}
       <tr>
           <td><input type="checkbox" onchange="selectRow(this)" class="check-row"></td>
           <td>{{ component.name }}</td>
           <td>{{ component.data_id }}
               {% for status in STATUSES %}
                   {% include "table_cell.html" %}
           {% endfor %}
       </tr>
    {% endfor %}
    </table>
    </div>

<script>
function selectAll(elem){
    for(let el of document.querySelectorAll('input.check-row')){
        el.checked = elem.checked
    }
}
function selectRow(elem){
    document.querySelector('#selectAll').checked = [...document.querySelectorAll('input.check-row')].every(x=>x.checked);
}
</script>
{% endblock %}